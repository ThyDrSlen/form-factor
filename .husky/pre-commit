#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

# FAST: Check for merge conflict markers FIRST (instant fail)
echo "ğŸ” Checking for merge conflict markers..."
STAGED_FILES=$(git diff --cached --name-only)
if [ -n "$STAGED_FILES" ]; then
    if echo "$STAGED_FILES" | xargs grep -lE '<<<<<<<|>>>>>>>|^=======$' 2>/dev/null; then
        echo "âŒ ERROR: Merge conflict markers found in staged files!"
        echo "Fix conflicts before committing."
        exit 1
    fi
fi
echo "âœ… No conflict markers found"

echo "ğŸ” Running lint + type-check before commit..."
bun run ci:local
